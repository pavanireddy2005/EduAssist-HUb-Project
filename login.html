<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Login - EduAssist Hub</title>
    <link rel="shortcut icon" href="logo.jpeg" />
    <link rel="stylesheet" href="login.css" />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
  </head>

  <body>
    <!-- ================= NAVBAR ================= -->
    <header class="navbar">
      <div class="nav-container">
        <a class="logo" href="index.html">
          <img src="logo.jpeg" alt="EduAssist Hub Logo" />
          <p class="logo-name"><b>EduAssist Hub</b></p>
        </a>

        <nav class="nav-links">
          <a href="index.html">Home</a>
          <a href="aboutus.html">About Us</a>
          <a href="contact.html">Contact</a>
          <a href="login.html" class="btn-login">Login / Sign Up</a>
        </nav>
      </div>
    </header>

    <!-- ================= AUTH CONTAINER ================= -->
    <div class="auth-container">
      <!-- LOGIN -->
      <div class="auth-box" id="loginForm">
        <h2>Login</h2>

        <input type="email" id="loginEmail" placeholder="Email Address" />
        <input type="password" id="loginPassword" placeholder="Password" />

        <a href="#" class="forgot-link" onclick="showForgotForm()"
          >Forgot Password?</a
        >

        <button class="login-btn" onclick="loginUser()">Login</button>
        <p id="loginError" class="error-msg"></p>

        <p>
          Don't have an account?
          <a href="#" onclick="showSignupForm()">Sign Up</a>
        </p>
      </div>

      <!-- SIGNUP -->
      <div class="auth-box" id="signupForm" style="display: none">
        <h2>Sign Up</h2>

        <input type="email" id="signupEmail" placeholder="Email Address" />
        <input type="password" id="signupPassword" placeholder="Password" />

        <button class="login-btn" onclick="signupUser()">Create Account</button>

        <p>
          Already have an account?
          <a href="#" onclick="showLoginForm()">Login</a>
        </p>

        <p id="signupMessage"></p>
      </div>

      <!-- FORGOT PASSWORD -->
      <div class="auth-box" id="forgotForm" style="display: none">
        <h2>Reset Password</h2>

        <input
          type="email"
          id="resetEmail"
          placeholder="Enter your registered email"
        />

        <button class="login-btn" onclick="sendResetEmail()">
          Send Reset Link
        </button>
        <p id="resetMessage"></p>

        <p><a href="#" onclick="showLoginForm()">‚Üê Back to Login</a></p>
      </div>
    </div>

    <!-- ================= FIREBASE ================= -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <script>
      // üî• REPLACE WITH YOUR FIREBASE CONFIG
      const firebaseConfig = {
        apiKey: "AIzaSyBSTIpOEBIqmLqYoXIeus3ydb8op1_1Bhs",
        authDomain: "eduassist-hub-57c4f.firebaseapp.com",
        projectId: "eduassist-hub-57c4f",
        storageBucket: "eduassist-hub-57c4f.firebasestorage.app",
        messagingSenderId: "383241607046",
        appId: "1:383241607046:web:bb9351db21794cb9587e07",
        measurementId: "G-E24KFP61JS",
      };
    </script>
    <script>
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
    </script>

    <!-- ================= AUTH LOGIC ================= -->
    <script>
      function sendResetEmail() {
        const email = document.getElementById("resetEmail").value.trim();
        const msg = document.getElementById("resetMessage");

        msg.textContent = "";
        msg.className = "";

        if (!email) {
          msg.textContent = "Please enter your email address.";
          msg.className = "error-msg";
          return;
        }

        auth
          .sendPasswordResetEmail(email)
          .then(() => {
            msg.textContent = "‚úÖ Password reset link sent. Check your email.";
            msg.className = "success-msg";

            // Optional: return to login after 3 seconds
            setTimeout(() => {
              showLoginForm();
              msg.textContent = "";
            }, 3000);
          })
          .catch((error) => {
            if (error.code === "auth/user-not-found") {
              msg.textContent = "‚ùå No account found with this email.";
            } else if (error.code === "auth/invalid-email") {
              msg.textContent = "‚ùå Invalid email address.";
            } else {
              msg.textContent = error.message;
            }
            msg.className = "error-msg";
          });
      }
    </script>

    <script>
      function loginUser() {
        const email = document.getElementById("loginEmail").value;
        const password = document.getElementById("loginPassword").value;
        const errorBox = document.getElementById("loginError");

        errorBox.textContent = "";

        if (!email || !password) {
          errorBox.textContent = "Please enter email and password.";
          return;
        }

        auth
          .signInWithEmailAndPassword(email, password)
          .then(() => {
            localStorage.setItem("isLoggedIn", "true");
            window.location.href = "dashboard.html";
          })
          .catch((error) => {
            if (error.code === "auth/invalid-login-credentials") {
              errorBox.textContent = "‚ùå Invalid email or password.";
            } else if (error.code === "auth/user-not-found") {
              errorBox.textContent = "‚ùå No account found with this email.";
            } else {
              errorBox.textContent = error.message;
            }

            document.getElementById("loginPassword").value = "";
          });
      }
    </script>
    <script>
      function showSignupForm() {
        document.getElementById("loginForm").style.display = "none";
        document.getElementById("forgotForm").style.display = "none";
        document.getElementById("signupForm").style.display = "block";
      }

      function showLoginForm() {
        document.getElementById("signupForm").style.display = "none";
        document.getElementById("forgotForm").style.display = "none";
        document.getElementById("loginForm").style.display = "block";
      }

      function showForgotForm() {
        document.getElementById("loginForm").style.display = "none";
        document.getElementById("signupForm").style.display = "none";
        document.getElementById("forgotForm").style.display = "block";
      }
    </script>
    <script>
      function signupUser() {
        const email = document.getElementById("signupEmail").value.trim();
        const password = document.getElementById("signupPassword").value.trim();
        const msg = document.getElementById("signupMessage");

        msg.textContent = "";
        msg.className = "";

        if (!email || !password) {
          msg.textContent = "Please enter email and password.";
          msg.className = "error-msg";
          return;
        }

        if (password.length < 6) {
          msg.textContent = "Password must be at least 6 characters.";
          msg.className = "error-msg";
          return;
        }

        auth
          .createUserWithEmailAndPassword(email, password)
          .then(() => {
            localStorage.setItem("isLoggedIn", "true");

            msg.textContent = "‚úÖ Account created successfully!";
            msg.className = "success-msg";

            setTimeout(() => {
              window.location.href = "dashboard.html";
            }, 1200);
          })
          .catch((error) => {
            if (error.code === "auth/email-already-in-use") {
              msg.textContent = "‚ùå Email already registered.";
            } else if (error.code === "auth/invalid-email") {
              msg.textContent = "‚ùå Invalid email address.";
            } else {
              msg.textContent = error.message;
            }
            msg.className = "error-msg";
          });
      }
    </script>

    <!-- ================= FOOTER ================= -->
    <footer class="white-footer">
      <h3>Follow Us</h3>
      <div class="social-icons">
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-linkedin-in"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-facebook-f"></i></a>
      </div>
    </footer>
  </body>
</html>
